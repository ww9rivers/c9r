-*- mode:python; -*-

Test 1: Test basics

>>> from c9r.app import Command
>>> app = Command() ## allow -d for debugging
>>> import time
>>> from c9r.file.config import Config, TextPassword
>>> cnf = Config(dict(a='aaa', b=time.strftime('%F %H:%M:%S')))
>>> cnf.config('a')
'aaa'
>>> try:
...   cnf.save()
... except AttributeError:
...   print('Nothing to save to.')
Nothing to save to.

Test 2:

>>> fname = 'test/config.test.json'
>>> cnf.save(fname)
>>> bcnf = Config(fname)
>>> bcnf.config('b') == cnf['b']
True

Test 3: Testing initconf

>>> initconf = dict(a='aaa', b='bbb')
>>> conf3 = Config(initconf=initconf)
>>> conf3.config('a')
'aaa'

Test 4: Testing include()

  >>> import os
  >>> os.system('touch /tmp/file1')
  0
  >>> os.system('''echo '{ "a": 123 }' > /tmp/file2.json''')
  0
  >>> conf3.include('/tmp')
  >>> conf3.a
  123
  >>> conf3.b
  'bbb'
  >>> os.system('rm /tmp/file1 /tmp/file2.json')
  0

Test 5: Hiding password
  >>> import base64
  >>> pw = TextPassword('password', True)
  >>> pw.cleartext()
  'password'
  >>> str(pw)
  'cGFzc3dvcmQ='
  >>> pw
  cGFzc3dvcmQ=
  >>> pw2 = TextPassword('cGFzc3dvcmQ=')
  >>> pw.cleartext()
  'password'
  >>> str(pw)
  'cGFzc3dvcmQ='
  >>> pw
  cGFzc3dvcmQ=
